# V1.5 é¡¹ç›®å¯è¡Œæ€§åˆ†æå¸ˆ - æ¶æ„è®¾è®¡æ–‡æ¡£

**ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-12-06
**ä½œè€…**: AI Project Analyzer Team

---

## ç›®å½•

1. [æ¶æ„æ¦‚è§ˆ](#æ¶æ„æ¦‚è§ˆ)
2. [è®¾è®¡åŠ¨æœº](#è®¾è®¡åŠ¨æœº)
3. [åŒè½¨å¹¶è¡ŒèŒƒå¼](#åŒè½¨å¹¶è¡ŒèŒƒå¼)
4. [æ ¸å¿ƒç»„ä»¶](#æ ¸å¿ƒç»„ä»¶)
5. [æ•°æ®æµ](#æ•°æ®æµ)
6. [ä¸V1çš„å…³ç³»](#ä¸v1çš„å…³ç³»)
7. [æŠ€æœ¯å®ç°](#æŠ€æœ¯å®ç°)
8. [æ‰©å±•æ€§](#æ‰©å±•æ€§)

---

## æ¶æ„æ¦‚è§ˆ

V1.5é¡¹ç›®å¯è¡Œæ€§åˆ†æå¸ˆï¼ˆFeasibility Analystï¼‰æ˜¯å¯¹V1éœ€æ±‚åˆ†æå¸ˆçš„**äº’è¡¥å¢å¼º**ï¼Œå½¢æˆ"åŒè½¨å¹¶è¡Œ"æ¶æ„ï¼š

```
ç”¨æˆ·è¾“å…¥
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ V1 éœ€æ±‚åˆ†æå¸ˆ (Requirements Analyst)            â”‚
â”‚ èŒƒå¼: æˆ˜ç•¥æ´å¯Ÿ (Strategic Insight)              â”‚
â”‚ å…³æ³¨: äººçš„æ·±å±‚éœ€æ±‚ã€èº«ä»½è®¤åŒã€ä»·å€¼å†²çª         â”‚
â”‚ è¾“å‡º: project_task, design_challenge, ...      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ V1.5 é¡¹ç›®å¯è¡Œæ€§åˆ†æå¸ˆ (Feasibility Analyst)     â”‚  ğŸ†• æ–°å¢
â”‚ èŒƒå¼: é¡¹ç›®ç®¡ç† (Project Management)             â”‚
â”‚ å…³æ³¨: èµ„æºçº¦æŸéªŒè¯ã€å†²çªæ£€æµ‹ã€ä¼˜å…ˆçº§æ’åº       â”‚
â”‚ è¾“å‡º: feasibility_assessment, priority_matrix  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
           å…¶ä»–ä¸“å®¶è§’è‰²
         (V2, V3, V4, V5, V6)
```

**æ ¸å¿ƒç‰¹æ€§**:
- âœ… **äº’è¡¥è€Œéæ›¿ä»£** - V1å…³æ³¨"ä¸ºä»€ä¹ˆ"ï¼ŒV1.5å…³æ³¨"èƒ½ä¸èƒ½"
- âœ… **é‡åŒ–éªŒè¯** - æä¾›é¢„ç®—/æ—¶é—´/ç©ºé—´çš„æ•°å€¼åŒ–å¯è¡Œæ€§åˆ†æ
- âœ… **é£é™©é¢„è­¦** - æå‰è¯†åˆ«èµ„æºçº¦æŸå†²çªï¼Œé¿å…é¡¹ç›®åæœŸé£é™©
- âœ… **å†³ç­–æ”¯æŒ** - æä¾›å¤šä¸ªå¯è¡Œæ–¹æ¡ˆåŠæƒè¡¡åˆ†æ

---

## è®¾è®¡åŠ¨æœº

### å‘ç°çš„é—®é¢˜

åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå‘ç°äº†**èŒƒå¼å·®å¼‚**ï¼š

| å¯¹æ¯”ç»´åº¦ | V1éœ€æ±‚åˆ†æå¸ˆï¼ˆå½“å‰ï¼‰ | ç”¨æˆ·å®é™…æœŸæœ› |
|---------|-------------------|------------|
| **è®¾è®¡å“²å­¦** | "æ·±åˆ»>å…¨é¢" - å…³æ³¨æ ¸å¿ƒçŸ›ç›¾ | "å…¨é¢>é—æ¼" - å…³æ³¨èµ„æºå¯è¡Œæ€§ |
| **è¾“å‡ºé‡ç‚¹** | äººçš„æ·±å±‚éœ€æ±‚ã€èº«ä»½è®¤åŒ | åŠŸèƒ½éœ€æ±‚ã€é¢„ç®—åˆ†é…ã€æ—¶é—´è®¡åˆ’ |
| **å†²çªå®šä¹‰** | å¿ƒç†/ç¤¾ä¼šçŸ›ç›¾ï¼ˆ"å±•ç¤ºvsç§å¯†"ï¼‰ | èµ„æºçº¦æŸå†²çªï¼ˆ"é¢„ç®—vséœ€æ±‚"ï¼‰ |
| **ä¼˜å…ˆçº§é€»è¾‘** | å±‚çº§ç»“æ„ï¼ˆç²¾ç¥>ç¤¾ä¼š>ç‰©è´¨ï¼‰ | æ•°å€¼åŒ–è®¡ç®—ï¼ˆæƒé‡Ã—å¿…è¦æ€§Ã—ç´§è¿«æ€§ï¼‰ |
| **ç›®æ ‡ç”¨æˆ·** | è®¾è®¡å¸ˆ/åˆ›æ„ä¸“ä¸šäººå£« | é¡¹ç›®ç»ç†/ä¸šä¸»/å†³ç­–è€… |

### å…¸å‹ç”¨æˆ·æ¡ˆä¾‹

**æ¡ˆä¾‹1**: æ™ºèƒ½å®¶å±…ç³»ç»Ÿ

**V1è¾“å‡º**ï¼ˆæˆ˜ç•¥æ´å¯Ÿï¼‰:
```json
{
  "project_task": "ä¸º[è¿½æ±‚ä¾¿æ·ç”Ÿæ´»çš„ç°ä»£å®¶åº­]+æ‰“é€ [å…¨å±‹æ™ºèƒ½ç©ºé—´]+é›‡ä½£ç©ºé—´å®Œæˆ[è®¾å¤‡è‡ªåŠ¨åŒ–è”åŠ¨]ä¸[è¯­éŸ³ä¾¿æ·æ§åˆ¶]",
  "design_challenge": "ä½œä¸º[æŠ€æœ¯æ‹¥æŠ±è€…]çš„[æ™ºèƒ½ä¾¿æ·éœ€æ±‚]ä¸[é¢„ç®—çµæ´»æ€§]çš„ä¸ç¡®å®šå¯¹ç«‹"
}
```

**ç”¨æˆ·æœŸæœ›**ï¼ˆé¡¹ç›®ç®¡ç†ï¼‰:
```json
{
  "functional_requirements": {
    "core_features": ["å…¨å±‹è®¾å¤‡è”åŠ¨", "è¯­éŸ³æ§åˆ¶"],
    "control_interfaces": ["è¯­éŸ³", "æ‰‹æœºAPP", "ä¸­æ§å±"]
  },
  "budget_constraints": {
    "type": "å¼¹æ€§é¢„ç®—",
    "estimated_range": "4-7ä¸‡å…ƒ"
  }
}
```

**æ¡ˆä¾‹2**: é¢„ç®—å†²çª

**ç”¨æˆ·è¾“å…¥**: "20ä¸‡é¢„ç®—è£…ä¿®200ã¡åˆ«å¢…ï¼Œè¦æ±‚å…¨è¿›å£ææ–™+æ™ºèƒ½å®¶å±…+ç§äººå½±é™¢"

**V1è¾“å‡º**:
- è¯†åˆ«æ·±å±‚éœ€æ±‚ï¼š"å±•ç¤ºå“å‘³çš„éœ€æ±‚"vs"é¢„ç®—æœ‰é™çš„ç°å®"
- ä½†ä¸ä¼šæ˜ç¡®å‘ŠçŸ¥ï¼šå®é™…éœ€è¦40-50ä¸‡ï¼Œé¢„ç®—ç¼ºå£20-30ä¸‡

**V1.5è¾“å‡º**:
```json
{
  "conflict_detection": {
    "budget_conflicts": [{
      "type": "é¢„ç®—vsåŠŸèƒ½å†²çª",
      "severity": "critical",
      "details": {
        "available_budget": 200000,
        "estimated_cost": 450000,
        "gap": 250000,
        "gap_percentage": 125
      },
      "description": "é¢„ç®—20ä¸‡ï¼Œä½†éœ€æ±‚æˆæœ¬45ä¸‡ï¼Œç¼ºå£25ä¸‡ï¼ˆè¶…é¢„ç®—125%ï¼‰"
    }]
  },
  "recommendations": [
    {
      "name": "æ–¹æ¡ˆA: ä¿é¢„ç®—æ–¹æ¡ˆ",
      "adjustments": ["ä¿ç•™æ™ºèƒ½å®¶å±…5ä¸‡", "å‰Šå‡ç§äººå½±é™¢æ”¹ä¸ºè§‚å½±åŒº", "ææ–™é™çº§ä¸ºå›½äº§é«˜ç«¯"],
      "adjusted_cost": {"total": 200000, "gap_from_budget": 0}
    },
    {
      "name": "æ–¹æ¡ˆB: åˆ†æœŸå®æ–½",
      "adjustments": ["ä¸€æœŸ20ä¸‡å®ŒæˆåŸºç¡€è£…ä¿®+æ™ºèƒ½å®¶å±…", "äºŒæœŸ15ä¸‡å®ç°ç§äººå½±é™¢"],
      "adjusted_cost": {"phase1": 200000, "phase2": 150000}
    }
  ]
}
```

### ä¸ºä»€ä¹ˆæ˜¯åŒè½¨å¹¶è¡Œï¼Ÿ

**ä¸ºä»€ä¹ˆä¸æ˜¯"æ›¿æ¢V1"ï¼Ÿ**
- âŒ V1çš„æˆ˜ç•¥æ´å¯Ÿæ˜¯æ ¸å¿ƒç«äº‰åŠ›ï¼Œä¸åº”ä¸¢å¼ƒ
- âŒ é¡¹ç›®ç®¡ç†èŒƒå¼æ— æ³•æä¾›è®¾è®¡æ´å¯Ÿ

**ä¸ºä»€ä¹ˆä¸æ˜¯"V1å†…éƒ¨å¢å¼º"ï¼Ÿ**
- âŒ è§’è‰²èŒè´£æ¨¡ç³Šï¼ˆæ—¢è¦æˆ˜ç•¥åˆè¦æ‰§è¡Œï¼‰
- âŒ æç¤ºè¯ä¼šå˜å¾—è¿‡é•¿å’Œå¤æ‚
- âŒ ç¨€é‡ŠV1çš„æ ¸å¿ƒä»·å€¼

**ä¸ºä»€ä¹ˆæ˜¯"åŒè½¨å¹¶è¡Œ"ï¼Ÿ**
- âœ… æ¸…æ™°çš„èŒè´£åˆ†å·¥ï¼ˆV1=æ´å¯Ÿï¼ŒV1.5=éªŒè¯ï¼‰
- âœ… ä¸¤è€…äº’è¡¥è€Œéå†²çª
- âœ… ç”¨æˆ·å¯æ ¹æ®åœºæ™¯é€‰æ‹©å…³æ³¨ç‚¹
- âœ… ç¬¦åˆä¸“å®¶åä½œæ¨¡å¼

---

## åŒè½¨å¹¶è¡ŒèŒƒå¼

### V1: æˆ˜ç•¥æ´å¯ŸèŒƒå¼

**æ ¸å¿ƒé—®é¢˜**: "ç”¨æˆ·çœŸæ­£æƒ³è¦ä»€ä¹ˆï¼Ÿ"

**åˆ†ææ–¹æ³•**:
- Jobs-to-be-Doneæ¡†æ¶ï¼š"é›‡ä½£ç©ºé—´å®Œæˆä»€ä¹ˆä»»åŠ¡"
- èº«ä»½è®¤åŒåˆ†æï¼š"æƒ³æˆä¸ºçš„è‡ªå·±" vs "ç°å®ä¸­çš„è‡ªå·±"
- ä»·å€¼å†²çªè¯†åˆ«ï¼š"å±•ç¤º" vs "ç§å¯†"ã€"æ•ˆç‡" vs "ä½“éªŒ"

**è¾“å‡ºæ ¼å¼** (9ä¸ªç»“æ„åŒ–å­—æ®µ):
1. `project_task` - JTBDå…¬å¼
2. `character_narrative` - è¿‡å»â†’ç°åœ¨â†’æœªæ¥è½¬å˜å¼§çº¿
3. `design_challenge` - æ ¸å¿ƒè®¾è®¡çŸ›ç›¾
4. `physical_context` - ç‰©ç†ç¯å¢ƒ
5. `resource_constraints` - èµ„æºé™åˆ¶
6. `regulatory_requirements` - è§„èŒƒè¦æ±‚
7. `inspiration_references` - çµæ„Ÿå‚è€ƒ
8. `experience_behavior` - åœºæ™¯æè¿°
9. `expert_handoff` - ä¸“å®¶åä½œæ¥å£

**å…¸å‹ç”¨æˆ·**: è®¾è®¡å¸ˆã€åˆ›æ„ä¸“ä¸šäººå£«ã€è¿½æ±‚æ·±åº¦æ´å¯Ÿçš„ä¸šä¸»

---

### V1.5: é¡¹ç›®ç®¡ç†èŒƒå¼

**æ ¸å¿ƒé—®é¢˜**: "é¡¹ç›®èƒ½ä¸èƒ½åšï¼Ÿæ€ä¹ˆåšï¼Ÿ"

**åˆ†ææ–¹æ³•**:
- èµ„æºçº¦æŸéªŒè¯ï¼šé¢„ç®—/æ—¶é—´/ç©ºé—´å¯è¡Œæ€§è®¡ç®—
- å†²çªæ£€æµ‹ï¼šé‡åŒ–è¯„ä¼°èµ„æºç¼ºå£å’Œä¸¥é‡æ€§
- ä¼˜å…ˆçº§æ’åºï¼šstakeholder_weight Ã— necessity_level Ã— time_sensitivity

**è¾“å‡ºæ ¼å¼** (4ä¸ªæ ¸å¿ƒå­—æ®µ):
1. `feasibility_assessment` - æ€»ä½“å¯è¡Œæ€§è¯„ä¼°
2. `conflict_detection` - å†²çªæ£€æµ‹ç»“æœï¼ˆé¢„ç®—/æ—¶é—´/ç©ºé—´ï¼‰
3. `priority_matrix` - ä¼˜å…ˆçº§çŸ©é˜µï¼ˆæ•°å€¼åŒ–æ’åºï¼‰
4. `recommendations` - å†³ç­–å»ºè®®ï¼ˆ3-5ä¸ªæ–¹æ¡ˆ+æƒè¡¡ï¼‰

**å…¸å‹ç”¨æˆ·**: é¡¹ç›®ç»ç†ã€ä¸šä¸»/å†³ç­–è€…ã€éœ€è¦å¯è¡Œæ€§éªŒè¯çš„åœºæ™¯

---

### ä¸¤è€…å…³ç³»

```
V1è¾“å‡º â†’ V1.5è¾“å…¥
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

V1: project_task
"ä¸º[è¿½æ±‚ä¾¿æ·ç”Ÿæ´»çš„ç°ä»£å®¶åº­]+æ‰“é€ [å…¨å±‹æ™ºèƒ½ç©ºé—´]+é›‡ä½£ç©ºé—´å®Œæˆ[è®¾å¤‡è‡ªåŠ¨åŒ–è”åŠ¨]ä¸[è¯­éŸ³ä¾¿æ·æ§åˆ¶]"
    â†“ æå–å…³é”®è¯ï¼šæ™ºèƒ½å®¶å±…ã€å…¨å±‹ã€è”åŠ¨ã€è¯­éŸ³
    â†“
V1.5: æˆæœ¬ä¼°ç®—
- åŒ¹é…è¡Œä¸šæ ‡å‡†ï¼šsmart_home.core_system â†’ [40000, 70000]
- å…¸å‹æˆæœ¬ï¼š55000å…ƒ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

V1: resource_constraints
"é¢„ç®—: 20ä¸‡; å·¥æœŸ: 2ä¸ªæœˆ"
    â†“ è§£æçº¦æŸå€¼
    â†“
V1.5: å†²çªæ£€æµ‹
- å¯ç”¨é¢„ç®—ï¼š200000å…ƒ
- ä¼°ç®—æˆæœ¬ï¼š340000å…ƒï¼ˆæ™ºèƒ½å®¶å±…+ç§äººå½±é™¢+è£…ä¿®ï¼‰
- å†²çªï¼šcriticalï¼ˆè¶…é¢„ç®—70%ï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

V1: character_narrative
"ä»ä¼ ç»Ÿæ‰‹åŠ¨æ“ä½œåˆ°æ™ºèƒ½è¯­éŸ³æ§åˆ¶çš„è½¬å˜å¼§çº¿"
    â†“ æ¨æ–­éœ€æ±‚å±‚æ¬¡
    â†“
V1.5: ä¼˜å…ˆçº§è®¡ç®—
- necessity_type: "social"ï¼ˆèˆ’é€‚éœ€æ±‚ï¼‰
- necessity_level: 0.70
- priority_score: 0.40 Ã— 0.70 Ã— 0.75 = 0.21ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰
```

---

## æ ¸å¿ƒç»„ä»¶

### 1. è¡Œä¸šæ ‡å‡†çŸ¥è¯†åº“

**æ–‡ä»¶**: `intelligent_project_analyzer/knowledge_base/industry_standards.yaml`

**ç»“æ„**:
```yaml
version: "1.0"

# æˆæœ¬æ•°æ®åº“
residential_costs:
  smart_home:
    core_system: {total_cost: [40000, 70000]}
  home_theater:
    standard: {total_cost: [60000, 120000]}

# å†²çªé˜ˆå€¼
conflict_thresholds:
  budget:
    critical: 1.5  # æ€»æˆæœ¬æ˜¯é¢„ç®—çš„1.5å€ä»¥ä¸Šï¼ˆè¶…é¢„ç®—50%+ï¼‰
    high: 1.25
    medium: 1.1
  timeline:
    critical: 2.0
    high: 1.5
  space:
    critical: 1.5
    high: 1.3

# åˆ©ç›Šç›¸å…³è€…æƒé‡
stakeholder_weights:
  residential:
    owner: 0.40
    family_members: 0.30
    guests: 0.15

# éœ€æ±‚å±‚æ¬¡æƒé‡ï¼ˆé©¬æ–¯æ´›å±‚æ¬¡ï¼‰
necessity_levels:
  survival: {weight: 1.0}   # ç”Ÿå­˜éœ€æ±‚
  safety: {weight: 0.85}     # å®‰å…¨éœ€æ±‚
  social: {weight: 0.70}     # èˆ’é€‚/ç¤¾äº¤éœ€æ±‚
  esteem: {weight: 0.60}     # å°Šé‡éœ€æ±‚
  self_actualization: {weight: 0.50}  # è‡ªæˆ‘å®ç°

# æ—¶é—´æ•æ„Ÿæ€§
time_sensitivity:
  urgent: {weight: 1.0}
  important: {weight: 0.75}
  normal: {weight: 0.50}
  nice_to_have: {weight: 0.30}
```

**æ‰©å±•æ€§**:
- æ”¯æŒæ·»åŠ æ–°è¡Œä¸šç±»å‹ï¼ˆcommercial_costs, educational_costsç­‰ï¼‰
- æ”¯æŒåœ°åŸŸç³»æ•°è°ƒæ•´ï¼ˆä¸åŒåŸå¸‚çš„æˆæœ¬å·®å¼‚ï¼‰
- æ”¯æŒå¹´ä»½æ›´æ–°ï¼ˆå¸‚åœºä»·æ ¼æ³¢åŠ¨ï¼‰

---

### 2. æˆæœ¬è®¡ç®—å™¨ï¼ˆCostCalculatorï¼‰

**èŒè´£**: åŸºäºè¡Œä¸šæ ‡å‡†ä¼°ç®—éœ€æ±‚æˆæœ¬

**æ ¸å¿ƒæ–¹æ³•**:
```python
def estimate_cost(self, requirement_text: str) -> Tuple[int, int, int]:
    """
    ä¼°ç®—éœ€æ±‚æˆæœ¬

    Args:
        requirement_text: V1çš„project_taskæˆ–ç”¨æˆ·æè¿°

    Returns:
        (min_cost, typical_cost, max_cost)
    """
    # å…³é”®è¯åŒ¹é…
    if any(kw in requirement_text for kw in ["æ™ºèƒ½å®¶å±…", "å…¨å±‹æ™ºèƒ½"]):
        smart_costs = self.standards["residential_costs"]["smart_home"]["core_system"]
        cost_range = smart_costs["total_cost"]  # [40000, 70000]
        total_min += cost_range[0]
        total_max += cost_range[1]
        total_typical += (cost_range[0] + cost_range[1]) // 2

    return (total_min, total_typical, total_max)
```

**ç¤ºä¾‹è¾“å‡º**:
```python
# è¾“å…¥ï¼š"å…¨å±‹æ™ºèƒ½å®¶å±…ç³»ç»Ÿå’Œç§äººå½±é™¢"
# è¾“å‡ºï¼š(100000, 145000, 190000)
#       æ™ºèƒ½å®¶å±…[40k,70k] + ç§äººå½±é™¢[60k,120k]
```

---

### 3. å†²çªæ£€æµ‹å™¨ï¼ˆConflictDetectorï¼‰

**èŒè´£**: æ£€æµ‹é¢„ç®—/æ—¶é—´/ç©ºé—´çº¦æŸå†²çª

**æ ¸å¿ƒæ–¹æ³•**:

#### 3.1 é¢„ç®—å†²çªæ£€æµ‹

```python
def detect_budget_conflict(
    self,
    available_budget: Optional[int],
    estimated_cost: int
) -> Dict[str, Any]:
    """
    æ£€æµ‹é¢„ç®—å†²çª

    é€»è¾‘ï¼š
    - cost_ratio = estimated_cost / available_budget
    - critical: cost_ratio â‰¥ 1.5 (è¶…é¢„ç®—50%+)
    - high: cost_ratio â‰¥ 1.25 (è¶…é¢„ç®—25-50%)
    - medium: cost_ratio â‰¥ 1.1 (è¶…é¢„ç®—10-25%)
    """
    if available_budget is None:
        return {
            "type": "é¢„ç®—æœªæ˜ç¡®",
            "severity": "medium",
            "description": "é¢„ç®—æœªæ˜ç¡®ï¼Œå»ºè®®ç¡®å®šé¢„ç®—åŒºé—´"
        }

    cost_ratio = estimated_cost / available_budget

    if cost_ratio >= self.thresholds["budget"]["critical"]:
        severity = "critical"
    elif cost_ratio >= self.thresholds["budget"]["high"]:
        severity = "high"
    # ...

    return {
        "type": "é¢„ç®—vsåŠŸèƒ½å†²çª",
        "severity": severity,
        "detected": gap > 0,
        "details": {
            "available_budget": available_budget,
            "estimated_cost": estimated_cost,
            "gap": gap,
            "gap_percentage": int((cost_ratio - 1) * 100)
        }
    }
```

#### 3.2 æ—¶é—´å†²çªæ£€æµ‹

```python
def detect_timeline_conflict(
    self,
    available_days: Optional[int],
    required_days: int
) -> Dict[str, Any]:
    """
    æ£€æµ‹å·¥æœŸå†²çª

    é€»è¾‘ï¼š
    - time_ratio = required_days / available_days
    - critical: time_ratio â‰¥ 2.0 (æ‰€éœ€æ—¶é—´è¶…2å€)
    - high: time_ratio â‰¥ 1.5
    """
    time_ratio = required_days / available_days

    if time_ratio >= self.thresholds["timeline"]["critical"]:
        severity = "critical"
    # ...
```

#### 3.3 ç©ºé—´å†²çªæ£€æµ‹

```python
def detect_space_conflict(
    self,
    available_area: Optional[int],
    required_area: int
) -> Dict[str, Any]:
    """
    æ£€æµ‹ç©ºé—´å†²çª

    ç¤ºä¾‹ï¼š
    - 60ã¡å°æˆ·å‹è¦4æˆ¿2å…4ç‹¬ç«‹å«ç”Ÿé—´
    - required_area = 4Ã—10 + 2Ã—15 + 4Ã—4 = 86ã¡
    - area_ratio = 86/60 = 1.43 â†’ "high"å†²çª
    """
    area_ratio = required_area / available_area

    if area_ratio >= self.thresholds["space"]["critical"]:
        severity = "critical"
    # ...
```

---

### 4. ä¼˜å…ˆçº§å¼•æ“ï¼ˆPriorityEngineï¼‰

**èŒè´£**: è®¡ç®—éœ€æ±‚ä¼˜å…ˆçº§åˆ†æ•°

**æ ¸å¿ƒå…¬å¼**:
```
priority_score = stakeholder_weight Ã— necessity_level Ã— time_sensitivity
```

**ç»´åº¦è¯´æ˜**:

| ç»´åº¦ | å–å€¼èŒƒå›´ | è¯´æ˜ |
|-----|---------|------|
| **stakeholder_weight** | 0-1 | ä¸šä¸»0.4, å®¶åº­æˆå‘˜0.3, è®¿å®¢0.15, æŠ•èµ„0.15 |
| **necessity_level** | 0-1 | ç”Ÿå­˜1.0, å®‰å…¨0.85, ç¤¾äº¤0.7, å°Šé‡0.6, è‡ªæˆ‘å®ç°0.5 |
| **time_sensitivity** | 0-1 | urgent 1.0, important 0.75, normal 0.5, nice_to_have 0.3 |

**æ ¸å¿ƒæ–¹æ³•**:

```python
def calculate_priority(
    self,
    requirement: str,
    stakeholder_type: str = "owner",
    necessity_type: str = "social",
    sensitivity_type: str = "important"
) -> Tuple[float, Dict[str, float]]:
    """
    è®¡ç®—ä¼˜å…ˆçº§åˆ†æ•°

    Returns:
        (priority_score, breakdown)
    """
    stakeholder_weight = self.stakeholder_weights.get(stakeholder_type, 0.40)
    necessity_level = self.necessity_levels.get(necessity_type, {}).get("weight", 0.60)
    time_weight = self.time_sensitivity.get(sensitivity_type, {}).get("weight", 0.75)

    priority_score = stakeholder_weight * necessity_level * time_weight

    breakdown = {
        "stakeholder_weight": stakeholder_weight,
        "necessity_level": necessity_level,
        "time_sensitivity": time_weight
    }

    return (priority_score, breakdown)

def infer_necessity_type(self, requirement_text: str) -> str:
    """æ¨æ–­éœ€æ±‚å±‚æ¬¡ç±»å‹"""
    if any(kw in requirement_text for kw in ["æ¶ˆé˜²", "é˜²ç›—", "éšç§", "å®‰å…¨"]):
        return "safety"
    elif any(kw in requirement_text for kw in ["æ™ºèƒ½", "èˆ’é€‚", "ä¾¿æ·"]):
        return "social"
    elif any(kw in requirement_text for kw in ["å“ç‰Œ", "è¿›å£", "å¥¢å", "é«˜ç«¯"]):
        return "esteem"
    elif any(kw in requirement_text for kw in ["å®šåˆ¶", "è‰ºæœ¯", "æ”¶è—", "å½±é™¢"]):
        return "self_actualization"
    else:
        return "social"  # é»˜è®¤ç¤¾äº¤éœ€æ±‚
```

**ç¤ºä¾‹è®¡ç®—**:

```python
# æ™ºèƒ½å®¶å±…ç³»ç»Ÿ
priority_score = 0.40 Ã— 0.70 Ã— 0.75 = 0.21ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰
# - ä¸šä¸»éœ€æ±‚ï¼ˆ0.40ï¼‰
# - èˆ’é€‚éœ€æ±‚ï¼ˆ0.70ï¼‰
# - é‡è¦ä½†ä¸ç´§æ€¥ï¼ˆ0.75ï¼‰

# ç§äººå½±é™¢
priority_score = 0.40 Ã— 0.50 Ã— 0.50 = 0.10ï¼ˆä½ä¼˜å…ˆçº§ï¼‰
# - ä¸šä¸»éœ€æ±‚ï¼ˆ0.40ï¼‰
# - è‡ªæˆ‘å®ç°éœ€æ±‚ï¼ˆ0.50ï¼‰
# - ä¸€èˆ¬éœ€æ±‚ï¼ˆ0.50ï¼‰
```

---

## æ•°æ®æµ

### å®Œæ•´æµç¨‹

```
1. ç”¨æˆ·è¾“å…¥
   â†“
2. V1éœ€æ±‚åˆ†æå¸ˆ
   è¾“å‡º: structured_requirements (9ä¸ªå­—æ®µ)
   â†“
3. V1.5å¯è¡Œæ€§åˆ†æå¸ˆ

   é˜¶æ®µ1: éœ€æ±‚æ‹†è§£ä¸æˆæœ¬ä¼°ç®—
   â”œâ”€ æå–V1çš„project_task
   â”œâ”€ å…³é”®è¯åŒ¹é…ï¼ˆæ™ºèƒ½å®¶å±…/ç§äººå½±é™¢/...ï¼‰
   â”œâ”€ æŸ¥è¯¢industry_standards.yaml
   â””â”€ è¾“å‡º: requirements_breakdown + total_estimated_cost

   é˜¶æ®µ2: å†²çªæ£€æµ‹
   â”œâ”€ æå–V1çš„resource_constraints
   â”œâ”€ è§£æé¢„ç®—/å·¥æœŸ/é¢ç§¯
   â”œâ”€ è°ƒç”¨ConflictDetector
   â””â”€ è¾“å‡º: budget_conflicts + timeline_conflicts + space_conflicts

   é˜¶æ®µ3: ä¼˜å…ˆçº§è®¡ç®—
   â”œâ”€ éå†æ¯ä¸ªéœ€æ±‚
   â”œâ”€ æ¨æ–­necessity_typeï¼ˆåŸºäºå…³é”®è¯ï¼‰
   â”œâ”€ è°ƒç”¨PriorityEngine.calculate_priority()
   â””â”€ è¾“å‡º: priority_matrixï¼ˆæŒ‰scoreé™åºæ’åˆ—ï¼‰

   é˜¶æ®µ4: å†³ç­–å»ºè®®ç”Ÿæˆ
   â”œâ”€ åŸºäºå†²çªä¸¥é‡æ€§
   â”œâ”€ åŸºäºä¼˜å…ˆçº§æ’åº
   â”œâ”€ è®¾è®¡3-5ä¸ªæ–¹æ¡ˆï¼ˆä¿é¢„ç®—/ä¿å“è´¨/åˆ†æœŸ/é™çº§ï¼‰
   â””â”€ è¾“å‡º: recommendations + risk_flags

   â†“
4. è¾“å‡ºJSONç»“æœ
   {
     "feasibility_assessment": {...},
     "conflict_detection": {...},
     "priority_matrix": [...],
     "recommendations": [...]
   }
```

### è¾“å…¥è¾“å‡ºç¤ºä¾‹

**è¾“å…¥**ï¼ˆV1çš„è¾“å‡ºï¼‰:
```json
{
  "project_task": "ä¸º[è¿½æ±‚å“è´¨ç”Ÿæ´»çš„ä¸‰å£ä¹‹å®¶]+æ‰“é€ [200ã¡æ™ºèƒ½åˆ«å¢…]+é›‡ä½£ç©ºé—´å®Œæˆ[å…¨å±‹æ™ºèƒ½è”åŠ¨]ä¸[å½±éŸ³å¨±ä¹äº«å—]",
  "resource_constraints": "é¢„ç®—: 20ä¸‡; å·¥æœŸ: 2ä¸ªæœˆ",
  "physical_context": "ç‹¬æ ‹åˆ«å¢…ï¼Œ200ã¡ï¼Œ3å±‚"
}
```

**è¾“å‡º**ï¼ˆV1.5çš„è¾“å‡ºï¼‰:
```json
{
  "feasibility_assessment": {
    "overall_feasibility": "low",
    "critical_issues": [
      "é¢„ç®—ç¼ºå£12-17ä¸‡ï¼ˆè¶…é¢„ç®—60-85%ï¼‰",
      "å·¥æœŸç´§å¼ ï¼ˆæ ‡å‡†å·¥æœŸéœ€3-3.5ä¸ªæœˆï¼‰"
    ],
    "summary": "é¡¹ç›®éœ€æ±‚æ˜ç¡®ä½†èµ„æºçº¦æŸä¸¥é‡ã€‚å»ºè®®é‡‡ç”¨åˆ†æœŸå®æ–½æ–¹æ¡ˆã€‚"
  },

  "conflict_detection": {
    "budget_conflicts": [{
      "type": "é¢„ç®—vsåŠŸèƒ½å†²çª",
      "severity": "critical",
      "detected": true,
      "details": {
        "available_budget": 200000,
        "estimated_cost_typical": 370000,
        "gap_typical": 170000,
        "gap_percentage": 85
      },
      "description": "é¢„ç®—20ä¸‡ï¼Œä½†å…¨å±‹æ™ºèƒ½ï¼ˆ6ä¸‡ï¼‰+ç§äººå½±é™¢ï¼ˆ9ä¸‡ï¼‰+200ã¡è£…ä¿®ï¼ˆ40ä¸‡ï¼‰å…¸å‹æ€»æˆæœ¬37ä¸‡ï¼Œç¼ºå£17ä¸‡"
    }],

    "timeline_conflicts": [{
      "type": "æ—¶é—´vsè´¨é‡å†²çª",
      "severity": "medium",
      "detected": true,
      "details": {
        "available_days": 60,
        "required_days_standard": 90,
        "gap": 30
      },
      "description": "2ä¸ªæœˆï¼ˆ60å¤©ï¼‰å®Œæˆ200ã¡è£…ä¿®ï¼Œæ ‡å‡†å·¥æœŸéœ€90å¤©ï¼Œå­˜åœ¨30å¤©ç¼ºå£"
    }]
  },

  "priority_matrix": [
    {
      "requirement": "å…¨å±‹æ™ºèƒ½å®¶å±…ç³»ç»Ÿ",
      "priority_score": 0.216,
      "breakdown": {
        "stakeholder_weight": 0.40,
        "necessity_level": 0.60,
        "time_sensitivity": 0.90
      },
      "rank": 1,
      "estimated_cost": 60000,
      "rationale": "ä¸‰å£ä¹‹å®¶æ ¸å¿ƒéœ€æ±‚ï¼ˆä¸šä¸»+å®¶åº­æˆå‘˜ï¼‰ï¼Œå±äºèˆ’é€‚éœ€æ±‚ï¼Œå·¥æœŸç´§å¼ "
    },
    {
      "requirement": "ç§äººå½±é™¢",
      "priority_score": 0.080,
      "breakdown": {
        "stakeholder_weight": 0.40,
        "necessity_level": 0.40,
        "time_sensitivity": 0.50
      },
      "rank": 2,
      "estimated_cost": 90000,
      "rationale": "ä¸šä¸»ä¸ªäººéœ€æ±‚ï¼Œå±äºè‡ªæˆ‘å®ç°éœ€æ±‚ï¼Œæ—¶é—´æ•æ„Ÿæ€§ä¸€èˆ¬"
    }
  ],

  "recommendations": [
    {
      "name": "æ–¹æ¡ˆA: åˆ†æœŸå®æ–½ï¼ˆæ¨èï¼‰",
      "strategy": "ä¸€æœŸæ»¡è¶³æ ¸å¿ƒéœ€æ±‚ï¼ŒäºŒæœŸæ‰©å±•",
      "adjustments": [
        "ä¸€æœŸï¼ˆ20ä¸‡ï¼‰: åŸºç¡€è£…ä¿®ï¼ˆ1000å…ƒ/ã¡Ã—200ã¡=20ä¸‡ï¼Œæ ‡å‡†æ¡£æ¬¡ï¼‰",
        "ä¸€æœŸï¼ˆé¢„ç•™æ¥å£ï¼‰: ä¸ºæ™ºèƒ½å®¶å±…å’Œå½±é™¢é¢„ç•™å¼ºå¼±ç”µæ¥å£",
        "äºŒæœŸï¼ˆ15ä¸‡ï¼‰: å…¨å±‹æ™ºèƒ½ï¼ˆ6ä¸‡ï¼‰+ æ ‡å‡†å½±é™¢ï¼ˆ9ä¸‡ï¼‰"
      ],
      "adjusted_cost": {
        "phase1": 200000,
        "phase2": 150000,
        "total": 350000,
        "gap_from_budget_phase1": 0
      },
      "trade_offs": {
        "pros": ["ä¸€æœŸé¢„ç®—è¾¾æ ‡", "åˆ†æ•£èµ„é‡‘å‹åŠ›", "å¯å…ˆå…¥ä½ä½“éªŒåä¼˜åŒ–"],
        "cons": ["äºŒæœŸæ–½å·¥å½±å“å±…ä½", "äºŒæœŸæ€»æˆæœ¬å¯èƒ½å¢åŠ 10-15%"]
      },
      "recommended": true
    }
  ],

  "risk_flags": [
    {
      "type": "é¢„ç®—é£é™©",
      "severity": "critical",
      "description": "å½“å‰é¢„ç®—ä¸éœ€æ±‚æˆæœ¬å·®è·è¾¾17ä¸‡ï¼ˆ85%ï¼‰ï¼Œå±äºä¸¥é‡èµ„æºä¸åŒ¹é…",
      "mitigation": "å»ºè®®é€‰æ‹©æ–¹æ¡ˆAï¼ˆåˆ†æœŸï¼‰æˆ–æ–¹æ¡ˆBï¼ˆå‰Šå‡ï¼‰ï¼Œé¿å…è¶…é¢„ç®—å¯¼è‡´é¡¹ç›®çƒ‚å°¾"
    }
  ]
}
```

---

## ä¸V1çš„å…³ç³»

### äº’è¡¥å…³ç³»è¡¨

| ç»´åº¦ | V1éœ€æ±‚åˆ†æå¸ˆ | V1.5å¯è¡Œæ€§åˆ†æå¸ˆ |
|-----|-------------|----------------|
| **å…³æ³¨ç„¦ç‚¹** | ä¸ºä»€ä¹ˆï¼ˆwhyï¼‰ | èƒ½ä¸èƒ½ï¼ˆcan/feasibleï¼‰ |
| **åˆ†ææ·±åº¦** | æ·±åº¦æ´å¯Ÿï¼ˆæ ¸å¿ƒçŸ›ç›¾ï¼‰ | å¹¿åº¦è¦†ç›–ï¼ˆå…¨é¢éªŒè¯ï¼‰ |
| **è¾“å‡ºæ€§è´¨** | å®šæ€§åˆ†æï¼ˆæè¿°æ€§ï¼‰ | å®šé‡åˆ†æï¼ˆæ•°å€¼åŒ–ï¼‰ |
| **å†³ç­–æ”¯æŒ** | æˆ˜ç•¥æ–¹å‘ï¼ˆåšä»€ä¹ˆï¼‰ | æ‰§è¡Œæ–¹æ¡ˆï¼ˆæ€ä¹ˆåšï¼‰ |
| **é£é™©è¯†åˆ«** | ä»·å€¼é£é™©ï¼ˆè®¾è®¡ä¸å¯¹ï¼‰ | èµ„æºé£é™©ï¼ˆåšä¸åˆ°ï¼‰ |
| **ç”¨æˆ·ä»·å€¼** | å¯å‘æ€è€ƒã€æä¾›æ´å¯Ÿ | éªŒè¯å¯è¡Œæ€§ã€è¾…åŠ©å†³ç­– |

### åä½œæ¨¡å¼

```python
def analyze_with_dual_track(user_input: str) -> Dict:
    """åŒè½¨å¹¶è¡Œåˆ†æ"""

    # Track 1: V1æˆ˜ç•¥æ´å¯Ÿ
    v1_output = requirements_analyst.analyze(user_input)
    # è¾“å‡ºï¼šproject_task, design_challenge, character_narrative, ...

    # Track 2: V1.5å¯è¡Œæ€§éªŒè¯
    v15_output = feasibility_analyst.analyze(v1_output)
    # è¾“å‡ºï¼šfeasibility_assessment, conflict_detection, priority_matrix, ...

    # æ•´åˆè¾“å‡º
    return {
        "strategic_insight": v1_output,     # æˆ˜ç•¥æ´å¯Ÿ
        "feasibility_check": v15_output,    # å¯è¡Œæ€§éªŒè¯
        "integration_notes": {
            "conflicts_alignment": "V1è¯†åˆ«çš„ä»·å€¼å†²çªä¸V1.5è¯†åˆ«çš„èµ„æºå†²çªå­˜åœ¨æ˜ å°„å…³ç³»",
            "priority_consistency": "V1çš„å±‚çº§ç»“æ„ä¸V1.5çš„æ•°å€¼åŒ–ä¼˜å…ˆçº§åŸºæœ¬ä¸€è‡´"
        }
    }
```

### ä½•æ—¶ä½¿ç”¨å“ªä¸ªï¼Ÿ

**ä»…ä½¿ç”¨V1** (æˆ˜ç•¥æ´å¯Ÿæ¨¡å¼):
- âœ… é¡¹ç›®åˆæœŸï¼Œå¤´è„‘é£æš´é˜¶æ®µ
- âœ… ç”¨æˆ·éœ€è¦è®¾è®¡çµæ„Ÿå’Œæ·±åº¦æ´å¯Ÿ
- âœ… é¢„ç®—/å·¥æœŸå°šæœªç¡®å®š
- âœ… ç›®æ ‡ç”¨æˆ·æ˜¯è®¾è®¡å¸ˆ/åˆ›æ„äººå‘˜

**V1 + V1.5** (åŒè½¨å¹¶è¡Œæ¨¡å¼):
- âœ… é¡¹ç›®è§„åˆ’é˜¶æ®µï¼Œéœ€è¦å¯è¡Œæ€§éªŒè¯
- âœ… é¢„ç®—/å·¥æœŸå·²æœ‰åˆæ­¥çº¦æŸ
- âœ… éœ€è¦å†³ç­–æ”¯æŒï¼ˆä¿é¢„ç®—è¿˜æ˜¯ä¿å“è´¨ï¼Ÿï¼‰
- âœ… ç›®æ ‡ç”¨æˆ·æ˜¯ä¸šä¸»/é¡¹ç›®ç»ç†/å†³ç­–è€…

**ç¤ºä¾‹å¯¹è¯**:

```
ç”¨æˆ·: "æˆ‘æƒ³è£…ä¿®ä¸€ä¸ª200ã¡çš„åˆ«å¢…ï¼Œé¢„ç®—20ä¸‡ï¼Œè¦æ™ºèƒ½å®¶å±…å’Œç§äººå½±é™¢"

ç³»ç»Ÿ:
ã€V1æˆ˜ç•¥æ´å¯Ÿã€‘
ä½ çš„éœ€æ±‚æœ¬è´¨æ˜¯"ä¸ºè¿½æ±‚å“è´¨ç”Ÿæ´»çš„å®¶åº­æ‰“é€ æ™ºèƒ½å¨±ä¹ç©ºé—´"ã€‚
æ ¸å¿ƒè®¾è®¡æŒ‘æˆ˜ï¼šä½œä¸º[ç§‘æŠ€çˆ±å¥½è€…]çš„[æ™ºèƒ½ä¾¿æ·éœ€æ±‚]ä¸[å½±éŸ³äº«å—éœ€æ±‚]ä¹‹é—´ï¼Œ
å­˜åœ¨é¢„ç®—çº¦æŸä¸‹çš„åŠŸèƒ½ä¼˜å…ˆçº§é€‰æ‹©ã€‚

ã€V1.5å¯è¡Œæ€§éªŒè¯ã€‘
âš ï¸ é¢„ç®—å†²çªï¼ˆcriticalï¼‰ï¼š
- å¯ç”¨é¢„ç®—ï¼š20ä¸‡
- ä¼°ç®—æˆæœ¬ï¼š37ä¸‡ï¼ˆæ™ºèƒ½å®¶å±…6ä¸‡+å½±é™¢9ä¸‡+è£…ä¿®22ä¸‡ï¼‰
- ç¼ºå£ï¼š17ä¸‡ï¼ˆ85%ï¼‰

ğŸ’¡ å»ºè®®æ–¹æ¡ˆï¼š
æ–¹æ¡ˆAï¼ˆæ¨èï¼‰: åˆ†æœŸå®æ–½
- ä¸€æœŸ20ä¸‡ï¼šå®ŒæˆåŸºç¡€è£…ä¿®+æ™ºèƒ½å®¶å±…ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰
- äºŒæœŸ15ä¸‡ï¼šå®ç°ç§äººå½±é™¢ï¼ˆæå‡åŠŸèƒ½ï¼‰
- ä¼˜åŠ¿ï¼šé¢„ç®—è¾¾æ ‡ï¼Œé£é™©å¯æ§
```

---

## æŠ€æœ¯å®ç°

### æ–‡ä»¶ç»“æ„

```
intelligent_project_analyzer/
â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ requirements_analyst.py        # V1éœ€æ±‚åˆ†æå¸ˆ
â”‚   â””â”€â”€ feasibility_analyst.py         # V1.5å¯è¡Œæ€§åˆ†æå¸ˆ ğŸ†•
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ prompts/
â”‚       â”œâ”€â”€ requirements_analyst_lite.yaml   # V1é…ç½®
â”‚       â””â”€â”€ feasibility_analyst.yaml         # V1.5é…ç½® ğŸ†•
â”‚
â”œâ”€â”€ knowledge_base/
â”‚   â””â”€â”€ industry_standards.yaml        # è¡Œä¸šæ ‡å‡†çŸ¥è¯†åº“ ğŸ†•
â”‚
â””â”€â”€ core/
    â”œâ”€â”€ state.py                       # çŠ¶æ€ç®¡ç†
    â””â”€â”€ types.py                       # ç±»å‹å®šä¹‰

tests/
â””â”€â”€ test_feasibility_analyst.py        # V1.5æµ‹è¯•å¥—ä»¶ ğŸ†•
```

### æ ¸å¿ƒç±»è®¾è®¡

```python
# feasibility_analyst.py

class FeasibilityAnalystAgent(LLMAgent):
    """V1.5 é¡¹ç›®å¯è¡Œæ€§åˆ†æå¸ˆæ™ºèƒ½ä½“"""

    def __init__(self, llm_model, config: Optional[Dict[str, Any]] = None):
        super().__init__(
            agent_type=AgentType.REQUIREMENTS_ANALYST,
            name="é¡¹ç›®å¯è¡Œæ€§åˆ†æå¸ˆ",
            description="éªŒè¯èµ„æºçº¦æŸã€æ£€æµ‹å†²çªã€è®¡ç®—ä¼˜å…ˆçº§ï¼Œæä¾›å¯è¡Œæ€§åˆ†æ",
            llm_model=llm_model,
            config=config
        )

        # åˆå§‹åŒ–æç¤ºè¯ç®¡ç†å™¨
        self.prompt_manager = PromptManager()

        # åŠ è½½è¡Œä¸šæ ‡å‡†çŸ¥è¯†åº“
        self.industry_standards = self._load_industry_standards()

        # åˆå§‹åŒ–å­å¼•æ“
        self.cost_calculator = CostCalculator(self.industry_standards)
        self.conflict_detector = ConflictDetector(self.industry_standards)
        self.priority_engine = PriorityEngine(self.industry_standards)

    def get_system_prompt(self) -> str:
        """è·å–ç³»ç»Ÿæç¤ºè¯"""
        prompt_config = self.prompt_manager.get_prompt("feasibility_analyst", return_full_config=True)
        return prompt_config.get("system_prompt", "")

    def get_task_description(self, state: ProjectAnalysisState) -> str:
        """è·å–å…·ä½“ä»»åŠ¡æè¿°"""
        structured_requirements = state.get("structured_requirements", {})

        task_description = f"""
# V1.5 å¯è¡Œæ€§åˆ†æä»»åŠ¡

## è¾“å…¥ï¼šV1éœ€æ±‚åˆ†æå¸ˆçš„è¾“å‡º

```json
{json.dumps(structured_requirements, ensure_ascii=False, indent=2)}
```

## ä½ çš„ä»»åŠ¡

åŸºäºV1çš„è¾“å‡ºï¼Œæ‰§è¡Œä»¥ä¸‹4ä¸ªé˜¶æ®µçš„åˆ†æï¼š

1. **éœ€æ±‚æ‹†è§£ä¸æˆæœ¬ä¼°ç®—** - è¯†åˆ«å…³é”®è¯ï¼ŒåŒ¹é…è¡Œä¸šæ ‡å‡†ï¼Œè®¡ç®—æ€»æˆæœ¬
2. **å†²çªæ£€æµ‹** - æ£€æŸ¥é¢„ç®—/æ—¶é—´/ç©ºé—´å¯è¡Œæ€§ï¼Œè¯†åˆ«ç¼ºå£
3. **ä¼˜å…ˆçº§è®¡ç®—** - ä¸ºæ¯ä¸ªéœ€æ±‚è®¡ç®—priority_score
4. **å†³ç­–å»ºè®®ç”Ÿæˆ** - ç”Ÿæˆ3-5ä¸ªå¯è¡Œæ–¹æ¡ˆï¼ˆä¿é¢„ç®—/ä¿å“è´¨/åˆ†æœŸ/é™çº§ï¼‰
"""
        return task_description


class CostCalculator:
    """æˆæœ¬è®¡ç®—å™¨ - åŸºäºè¡Œä¸šæ ‡å‡†ä¼°ç®—éœ€æ±‚æˆæœ¬"""

    def __init__(self, industry_standards: Dict[str, Any]):
        self.standards = industry_standards

    def estimate_cost(self, requirement_text: str) -> Tuple[int, int, int]:
        """ä¼°ç®—éœ€æ±‚æˆæœ¬ï¼Œè¿”å›: (min_cost, typical_cost, max_cost)"""
        # å®ç°è¯¦è§"æ ¸å¿ƒç»„ä»¶ > æˆæœ¬è®¡ç®—å™¨"ç« èŠ‚


class ConflictDetector:
    """å†²çªæ£€æµ‹å™¨ - æ£€æµ‹èµ„æºçº¦æŸå†²çª"""

    def __init__(self, industry_standards: Dict[str, Any]):
        self.standards = industry_standards
        self.thresholds = industry_standards.get("conflict_thresholds", {})

    def detect_budget_conflict(self, available_budget: Optional[int], estimated_cost: int):
        """æ£€æµ‹é¢„ç®—å†²çª"""
        # å®ç°è¯¦è§"æ ¸å¿ƒç»„ä»¶ > å†²çªæ£€æµ‹å™¨"ç« èŠ‚

    def detect_timeline_conflict(self, available_days: Optional[int], required_days: int):
        """æ£€æµ‹å·¥æœŸå†²çª"""

    def detect_space_conflict(self, available_area: Optional[int], required_area: int):
        """æ£€æµ‹ç©ºé—´å†²çª"""


class PriorityEngine:
    """ä¼˜å…ˆçº§è®¡ç®—å¼•æ“ - è®¡ç®—éœ€æ±‚ä¼˜å…ˆçº§åˆ†æ•°"""

    def __init__(self, industry_standards: Dict[str, Any]):
        self.standards = industry_standards
        self.stakeholder_weights = industry_standards.get("stakeholder_weights", {}).get("residential", {})
        self.necessity_levels = industry_standards.get("necessity_levels", {})
        self.time_sensitivity = industry_standards.get("time_sensitivity", {})

    def calculate_priority(
        self,
        requirement: str,
        stakeholder_type: str = "owner",
        necessity_type: str = "social",
        sensitivity_type: str = "important"
    ) -> Tuple[float, Dict[str, float]]:
        """è®¡ç®—ä¼˜å…ˆçº§åˆ†æ•°"""
        # å®ç°è¯¦è§"æ ¸å¿ƒç»„ä»¶ > ä¼˜å…ˆçº§å¼•æ“"ç« èŠ‚

    def infer_necessity_type(self, requirement_text: str) -> str:
        """æ¨æ–­éœ€æ±‚å±‚æ¬¡ç±»å‹"""
```

---

## æ‰©å±•æ€§

### 1. æ·»åŠ æ–°è¡Œä¸šç±»å‹

åœ¨`industry_standards.yaml`ä¸­æ·»åŠ æ–°é…ç½®ï¼š

```yaml
# æ–°å¢ï¼šå•†ä¸šç©ºé—´æˆæœ¬æ ‡å‡†
commercial_costs:
  retail_store:
    basic_decoration: {total_cost_per_sqm: [800, 1500]}
    mid_level: {total_cost_per_sqm: [1500, 3000]}
    high_end: {total_cost_per_sqm: [3000, 6000]}

  restaurant:
    fast_food: {total_cost_per_sqm: [2000, 4000]}
    casual_dining: {total_cost_per_sqm: [4000, 8000]}
    fine_dining: {total_cost_per_sqm: [8000, 15000]}

# æ–°å¢ï¼šå•†ä¸šç©ºé—´åˆ©ç›Šç›¸å…³è€…æƒé‡
stakeholder_weights:
  commercial:
    owner: 0.50      # ä¸šä¸»æƒé‡æ›´é«˜
    customers: 0.30  # é¡¾å®¢ä½“éªŒ
    employees: 0.15  # å‘˜å·¥éœ€æ±‚
    branding: 0.05   # å“ç‰Œå½¢è±¡
```

### 2. æ·»åŠ åœ°åŸŸç³»æ•°

```yaml
# æ–°å¢ï¼šåœ°åŸŸæˆæœ¬ç³»æ•°
regional_multipliers:
  tier1_cities:  # ä¸€çº¿åŸå¸‚
    beijing: 1.3
    shanghai: 1.35
    shenzhen: 1.25
  tier2_cities:  # äºŒçº¿åŸå¸‚
    hangzhou: 1.15
    chengdu: 1.10
  tier3_cities:  # ä¸‰çº¿åŸå¸‚
    default: 0.85

# ä½¿ç”¨æ–¹å¼
def estimate_cost_with_region(self, requirement_text: str, city: str):
    base_cost = self.estimate_cost(requirement_text)
    multiplier = self.standards["regional_multipliers"]["tier1_cities"].get(city, 1.0)
    return base_cost * multiplier
```

### 3. æ·»åŠ æ–°å†²çªç±»å‹

```python
class ConflictDetector:
    # æ–°å¢ï¼šæŠ€æœ¯å¯è¡Œæ€§å†²çªæ£€æµ‹
    def detect_technical_conflict(
        self,
        requirement_text: str,
        physical_context: Dict
    ) -> Dict[str, Any]:
        """
        æ£€æµ‹æŠ€æœ¯å¯è¡Œæ€§å†²çª

        ç¤ºä¾‹ï¼š
        - è€æ—§å»ºç­‘å®‰è£…ä¸­å¤®ç©ºè°ƒï¼ˆæ‰¿é‡ä¸è¶³ï¼‰
        - ä½å±‚é«˜ç©ºé—´å®ç°æŒ‘é«˜è®¾è®¡ï¼ˆç‰©ç†é™åˆ¶ï¼‰
        """
        conflicts = []

        # æ£€æµ‹æ‰¿é‡é™åˆ¶
        if "ä¸­å¤®ç©ºè°ƒ" in requirement_text:
            if physical_context.get("building_age", 0) > 30:
                conflicts.append({
                    "type": "æ‰¿é‡vsè®¾å¤‡å†²çª",
                    "severity": "high",
                    "description": "è€å»ºç­‘ï¼ˆ30å¹´+ï¼‰æ‰¿é‡å¯èƒ½ä¸è¶³ï¼Œéœ€ç»“æ„å·¥ç¨‹å¸ˆè¯„ä¼°"
                })

        return {"technical_conflicts": conflicts}
```

### 4. è‡ªå®šä¹‰ä¼˜å…ˆçº§ç®—æ³•

```python
class CustomPriorityEngine(PriorityEngine):
    """è‡ªå®šä¹‰ä¼˜å…ˆçº§å¼•æ“ - æ”¯æŒä¸åŒè®¡ç®—ç­–ç•¥"""

    def __init__(self, industry_standards, strategy="weighted"):
        super().__init__(industry_standards)
        self.strategy = strategy

    def calculate_priority(self, requirement, **kwargs):
        if self.strategy == "weighted":
            # åŠ æƒç­–ç•¥ï¼ˆå½“å‰é»˜è®¤ï¼‰
            return super().calculate_priority(requirement, **kwargs)

        elif self.strategy == "ahp":
            # å±‚æ¬¡åˆ†ææ³•ï¼ˆAHPï¼‰
            return self._calculate_priority_ahp(requirement, **kwargs)

        elif self.strategy == "fuzzy":
            # æ¨¡ç³Šç»¼åˆè¯„ä»·æ³•
            return self._calculate_priority_fuzzy(requirement, **kwargs)

    def _calculate_priority_ahp(self, requirement, **kwargs):
        """å±‚æ¬¡åˆ†ææ³•ï¼ˆé€‚ç”¨äºå¤šç›®æ ‡å†³ç­–ï¼‰"""
        # TODO: å®ç°AHPç®—æ³•
        pass
```

---

## æ€»ç»“

V1.5é¡¹ç›®å¯è¡Œæ€§åˆ†æå¸ˆçš„æ ¸å¿ƒä»·å€¼ï¼š

âœ… **äº’è¡¥å¢å¼º**: ä¿ç•™V1æˆ˜ç•¥æ´å¯Ÿï¼Œæ–°å¢å¯è¡Œæ€§éªŒè¯
âœ… **é‡åŒ–å†³ç­–**: æä¾›æ•°å€¼åŒ–çš„å†²çªæ£€æµ‹å’Œä¼˜å…ˆçº§æ’åº
âœ… **é£é™©é¢„è­¦**: æå‰è¯†åˆ«é¢„ç®—/æ—¶é—´/ç©ºé—´çº¦æŸé—®é¢˜
âœ… **æ–¹æ¡ˆå¯¹æ¯”**: ç”Ÿæˆå¤šä¸ªå¯è¡Œæ–¹æ¡ˆåŠæƒè¡¡åˆ†æ
âœ… **å¯æ‰©å±•æ€§**: æ”¯æŒæ–°è¡Œä¸šã€æ–°åœ°åŸŸã€æ–°å†²çªç±»å‹

**é€‚ç”¨åœºæ™¯**: é¡¹ç›®è§„åˆ’é˜¶æ®µã€èµ„æºçº¦æŸæ˜ç¡®æ—¶ã€éœ€è¦å†³ç­–æ”¯æŒçš„åœºæ™¯ã€‚

**ä¸é€‚ç”¨åœºæ™¯**: çº¯åˆ›æ„å¤´è„‘é£æš´ã€é¢„ç®—/å·¥æœŸå®Œå…¨æœªå®šã€ä»…éœ€è®¾è®¡çµæ„Ÿçš„åœºæ™¯ï¼ˆæ­¤æ—¶ä»…ç”¨V1å³å¯ï¼‰ã€‚

---

**ç‰ˆæœ¬å†å²**:
- v1.0 (2025-12-06): åˆå§‹ç‰ˆæœ¬ï¼Œå®ç°åŒè½¨å¹¶è¡Œæ¶æ„

**å‚è€ƒæ–‡æ¡£**:
- `V15_USER_GUIDE.md` - V1.5ç”¨æˆ·ä½¿ç”¨æŒ‡å—
- `intelligent_project_analyzer/config/prompts/feasibility_analyst.yaml` - V1.5é…ç½®æ–‡ä»¶
- `intelligent_project_analyzer/knowledge_base/industry_standards.yaml` - è¡Œä¸šæ ‡å‡†çŸ¥è¯†åº“
