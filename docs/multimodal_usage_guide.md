# 多模态输入快速使用指南

## 🚀 快速开始

### 1. 启动后端服务

```bash
cd intelligent_project_analyzer/api
python server.py
```

### 2. 启动前端

```bash
cd frontend-nextjs
npm run dev
```

### 3. 访问页面

打开浏览器访问：http://localhost:3000

---

## 💡 使用示例

### 示例1：纯文本输入（原有功能）

在输入框中输入：
```
我需要设计一个75平米的现代简约风格住宅，预算60万
```

点击发送按钮 ✅

### 示例2：上传TXT文件

1. 创建 `requirements.txt`：
```txt
详细需求：
- 户型：75平米一居室
- 风格：现代简约 + 英伦气质
- 预算：60万
- 重点：优雅仪式感 + 慵懒自由空间
```

2. 点击输入框左下角的 📎 按钮
3. 选择 `requirements.txt`
4. 查看文件列表显示
5. 点击发送 ✅

### 示例3：上传PDF参考案例

1. 准备PDF文件（设计案例、风格参考等）
2. 拖拽PDF到输入框区域
3. 输入框变为蓝色高亮
4. 松开鼠标，文件自动添加
5. 点击发送 ✅

### 示例4：混合输入（文本 + 多个文件）

1. 在输入框输入：`我需要设计一个现代简约住宅`
2. 上传 `requirements.txt`（详细需求）
3. 上传 `inspiration.jpg`（风格参考图）
4. 上传 `case_study.pdf`（案例分析）
5. 查看文件列表（显示3个文件）
6. 点击发送 ✅

---

## 📋 支持的文件类型

| 文件类型 | 扩展名 | 最大大小 | 提取内容 |
|---------|-------|---------|---------|
| PDF | `.pdf` | 10MB | 文本内容（按页） |
| 文本 | `.txt` | 5MB | 完整文本（自动检测编码） |
| 图片 | `.png`, `.jpg`, `.jpeg` | 5MB | 基本信息（尺寸、格式） |

---

## ⚠️ 注意事项

### 文件大小
- 单个文件最大10MB
- 超过大小会显示错误提示

### 文件类型
- 仅支持上表中列出的类型
- 不支持的类型会被自动拒绝

### 文件数量
- 建议：3-5个文件
- 过多文件会增加处理时间

### 文本编码
- TXT文件支持UTF-8、GBK、GB2312等
- 系统会自动检测和转换

---

## 🔍 后台处理流程

用户上传文件后，系统会：

1. **保存文件** → `data/uploads/{session_id}/`
2. **提取内容**：
   - PDF: 按页提取文本
   - TXT: 检测编码并读取
   - 图片: 提取尺寸信息
3. **合并输入**：
   ```
   ## 用户需求描述
   {你输入的文本}

   ## 附件材料
   ### 附件 1 (PDF)
   {PDF提取的文本}

   ### 附件 2 (TXT)
   {TXT文件内容}
   ```
4. **启动分析** → 工作流使用合并后的完整输入

---

## 🎨 界面说明

### 输入区域
- **拖拽上传**：拖拽文件到输入框，松开即可添加
- **点击上传**：点击 📎 按钮，选择文件
- **混合输入**：可以同时输入文本和上传文件

### 文件列表
- **文件图标**：PDF📄、TXT📝、图片🖼️
- **文件名**：显示原始文件名
- **文件大小**：自动格式化（KB/MB）
- **删除按钮**：鼠标悬停时显示 ❌

### 提交按钮
- **禁用状态**：无文本且无文件时
- **启用状态**：有文本或有文件时
- **加载状态**：提交后显示旋转动画

---

## 🐛 常见问题

### Q: 上传文件后没有反应？
A: 检查：
1. 文件大小是否超过10MB
2. 文件类型是否支持
3. 浏览器控制台是否有错误

### Q: PDF提取的文本乱码？
A: 可能原因：
1. PDF是扫描版（无文字层）
2. PDF使用了特殊字体
3. 建议：转换为文本文件后上传

### Q: 中文TXT文件显示乱码？
A: 系统会自动检测编码，支持：
- UTF-8
- GBK
- GB2312
- UTF-16

如果仍然乱码，建议转换为UTF-8编码。

### Q: 图片内容没有被分析？
A: 当前版本（v3.7）仅提取图片基本信息，内容分析功能计划在v3.8添加。

---

## 📞 技术支持

如遇问题，请查看：
1. 后端日志：`intelligent_project_analyzer/api/server.py` 输出
2. 前端控制台：浏览器开发者工具 → Console
3. 测试脚本：`python test_multimodal.py`

---

## 🎯 下一步

功能已完成！你现在可以：
1. ✅ 在首页上传多个文件
2. ✅ 混合文本和文件输入
3. ✅ 查看文件提取结果
4. ✅ 正常进行分析流程

**Enjoy!** 🎉
