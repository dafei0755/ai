# Phase 1.1 能力边界修正

> **修正时间:** 2025-12-02
> **修正原因:** 用户指出系统承诺了无法兑现的交付物
> **修正类型:** 能力边界声明 + 交付物转化规则

---

## 🎯 核心问题

### 用户反馈

> "注意对问题的理解，比如用户输入：75平米现代简约住宅完整设计方案"
> "我们的工作流不能做到真正意义上的完整，比如'平面图', '家具布置方案', '材料清单'。"
> "我们目前只能在设计策略/设计概念/设计思路/用户分析/行业市场判断/案例研究/方法论等等上。"
> "不能真正的做图纸，具体布置方案，也不能给材料清单等前置内容要明确的事情。"
> "要有实现的边界感，不能什么都能做，大包大揽。我们是有限的！"

### 问题诊断

Phase 1.0 在识别交付物时过于理想化，承诺了系统无法兑现的内容：

```
❌ Phase 1.0 问题:
用户："75平米住宅,需要平面图和材料清单"
系统识别：design_plan (平面图+材料清单)
实际能力：无法生成CAD图纸和精确材料清单

结果：
→ 承诺无法兑现
→ 用户期望落空
→ 问题从"缺少交付物"变成"交付物不符合预期"
```

---

## ✅ Phase 1.1 修正方案

### 修正策略

**核心理念：明确能力边界 + 转化为可交付的替代方案**

```
✅ Phase 1.1 修正:
用户："75平米住宅,需要平面图和材料清单"
系统判断：平面图/材料清单 → 超出能力
系统转化：design_strategy (空间设计策略文档)
  - 包含：平面规划思路/功能分区建议/材料选择指导
  - 价值：为建筑师/设计师提供决策依据（前置策略层）

结果：
→ 承诺可兑现的交付物
→ 用户理解系统定位
→ 交付的策略指导具有实际价值
```

---

## 📋 系统能力边界声明

### ✅ 系统能做的（策略/概念/分析层）

- **设计策略、设计理念、空间规划思路**
- **用户洞察、需求分析、场景研究**
- **品牌叙事、文案创作、命名策划**
- **案例研究、方法论、决策框架**
- **评估维度、选型指导、比较分析**

### ❌ 系统不能做的（具体执行层）

- **生成CAD图纸、施工图、3D效果图**
- **提供精确材料清单（品牌/型号/价格/供应商）**
- **进行精确成本估算（需要实时市场数据）**
- **技术参数级对比（需要产品数据库）**
- **可执行的采购清单（需要供应链数据）**

---

## 🔄 转化规则

### 核心转化规则表

| 用户期望 | 超出能力原因 | 转化为 | 交付价值 |
|---------|------------|-------|---------|
| **平面图** | 需要CAD软件 | **平面规划策略文档** | 空间规划思路/功能分区建议/动线设计原则 |
| **材料清单** | 需要产品数据库 | **材料选择指导原则** | 材料类型建议/风格匹配原则/选材标准 |
| **成本估算** | 需要实时市场数据 | **预算分配框架** | 预算分配比例建议/成本控制要点 |
| **技术参数对比** | 需要产品数据库 | **技术选型决策框架** | 评估维度/选型标准/风险分析 |
| **采购清单** | 需要供应链数据 | **采购决策指南** | 选品标准/供应商筛选维度 |

---

## 📁 修改的文件

### 1. requirements_analyst_lite.yaml

**版本:** v3.4 → v4.1-lite-boundary

**关键修改:**

#### A. 增加能力边界声明

```yaml
⚠️ **系统能力边界声明 - 必读！**

本系统是**战略/策略/概念层的智力输出系统**，专注于：
✅ 设计策略、设计理念、空间规划思路
✅ 用户洞察、需求分析、场景研究
✅ 品牌叙事、文案创作、命名策划
✅ 案例研究、方法论、决策框架
✅ 评估维度、选型指导、比较分析

本系统**不具备以下能力**（请勿承诺）：
❌ 生成CAD图纸、施工图、3D效果图
❌ 提供精确材料清单（品牌/型号/价格/供应商）
❌ 进行精确成本估算（需要实时市场数据）
❌ 技术参数级对比（需要产品数据库）
❌ 可执行的采购清单（需要供应链数据）
```

#### B. 修改交付物识别流程

```yaml
**交付物识别流程:**

**第一步：识别用户期望**
1. 用户最终要得到什么? (提取关键动词和名词)
2. 数量/格式/规格是什么?
3. 如何验收?

**第二步：能力边界判断**
- 如果用户期望在✅能力范围内 → 正常识别
- 如果用户期望超出❌能力范围 → 转化为可交付的替代方案

**转化规则（关键！）：**
用户期望 "平面图" → 转化为 "平面规划策略文档"
用户期望 "材料清单" → 转化为 "材料选择指导原则"
用户期望 "成本估算" → 转化为 "预算分配建议和成本控制策略"
用户期望 "技术参数对比" → 转化为 "技术选型决策框架"
用户期望 "采购清单" → 转化为 "采购决策指南和选品标准"
```

#### C. 更新交付物类型分类

```yaml
// 📝 **文案/创意类** (系统核心能力):
// - naming_list: 命名/取名/标题方案
// - brand_narrative: 品牌故事/叙事策略
// - copywriting_plan: 文案策划方案

// 🎨 **策略/指导类** (系统核心能力):
// - design_strategy: 设计策略文档
// - material_guidance: 材料选择指导原则
// - selection_framework: 选型决策框架
// - procurement_guidance: 采购决策指南
// - budget_framework: 预算分配框架

// ⚠️ **系统不建议的类型** (超出能力,需转化):
// - design_plan → 转化为 design_strategy
// - technical_spec → 转化为 selection_framework
// - procurement_list → 转化为 procurement_guidance
// - cost_estimate → 转化为 budget_framework
```

#### D. 修正5个场景示例

- **场景1 (命名)**: 保持不变，在能力范围内
- **场景2 (设计)**: 从 design_plan 转化为 design_strategy
- **场景3 (分析)**: 保持不变，在能力范围内
- **场景4 (技术)**: 从 technical_spec 转化为 selection_framework
- **场景5 (混合)**: 全部转化为策略/指导类

**文件位置:** [intelligent_project_analyzer/config/prompts/requirements_analyst_lite.yaml](intelligent_project_analyzer/config/prompts/requirements_analyst_lite.yaml:273-363)

---

### 2. project_director.yaml

**版本:** v6.0 → v6.1-boundary

**关键修改:**

#### A. 更新责任人映射规则

```yaml
📝 **文案/命名/叙事类**:
- naming_list, brand_narrative, copywriting_plan
  → V3_叙事与品牌专家

🎨 **设计策略类** (v4.1新增):
- design_strategy, material_guidance, spatial_concept
  → V2_设计总监

🔧 **技术/选型框架类** (v4.1修正):
- selection_framework, implementation_guide, evaluation_criteria
  → V6_专业总工程师

💰 **预算/采购指导类** (v4.1修正):
- budget_framework, procurement_guidance, cost_control_strategy
  → V6_专业总工程师 或 V5_场景专家
```

**文件位置:** [intelligent_project_analyzer/config/prompts/project_director.yaml](intelligent_project_analyzer/config/prompts/project_director.yaml:47-84)

---

## 📊 修正前后对比

### 测试用例2对比（代表性案例）

#### Phase 1.0 (修正前)

```json
{
  "user_input": "75平米现代简约住宅,需要平面图和材料清单",
  "primary_deliverables": [
    {
      "deliverable_id": "D1",
      "type": "design_plan",  // ❌ 超出能力
      "description": "75平米现代简约住宅完整设计方案",
      "format_requirements": {
        "must_include": ["平面图", "家具布置方案", "材料清单"]  // ❌ 无法交付
      },
      "acceptance_criteria": [
        "必须提供平面布局图(标注尺寸)",  // ❌ 需要CAD
        "必须有材料清单(含品牌/规格/预估价格)"  // ❌ 需要产品数据库
      ]
    }
  ]
}
```

**问题:**
- 承诺了系统无法生成的CAD图纸
- 承诺了系统没有的产品数据库

#### Phase 1.1 (修正后)

```json
{
  "user_input": "75平米现代简约住宅,需要平面图和材料清单",
  "primary_deliverables": [
    {
      "deliverable_id": "D1",
      "type": "design_strategy",  // ✅ 转化为策略
      "description": "75平米现代简约住宅空间设计策略文档",
      "format_requirements": {
        "must_include": [
          "平面规划思路",  // ✅ 可交付
          "功能分区建议",  // ✅ 可交付
          "动线设计原则",  // ✅ 可交付
          "材料选择指导"   // ✅ 可交付
        ]
      },
      "acceptance_criteria": [
        "必须提供清晰的空间规划思路和设计方向",  // ✅ 可验收
        "必须有功能分区的建议和依据",  // ✅ 可验收
        "必须有材料选择的指导原则和标准",  // ✅ 可验收
        "内容可作为建筑师/设计师的决策依据"  // ✅ 价值明确
      ]
    }
  ]
}
```

**改进:**
- 承诺可兑现的策略文档
- 明确交付价值：为后续执行提供决策依据
- 用户理解系统定位：策略层而非执行层

---

## 🎯 交付价值定位

### 系统的正确定位

```
用户需求完整流程:
┌─────────────────────────────────────────────┐
│ 1. 战略/策略层 (本系统的能力范围)             │
│    - 需求洞察和分析                          │
│    - 设计方向和策略                          │
│    - 决策框架和标准                          │
│    - 方法论和指导原则                        │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│ 2. 具体执行层 (需要人工设计师/工程师接力)     │
│    - CAD图纸绘制                             │
│    - 材料选型和询价                          │
│    - 施工图深化                              │
│    - 供应商对接                              │
└─────────────────────────────────────────────┘
```

### 价值主张

**系统交付的策略/指导文档的价值:**
1. **决策依据** - 为后续执行提供明确方向
2. **时间节省** - 减少设计师的前期思考和调研时间
3. **方法论** - 提供系统化的决策框架
4. **风险规避** - 通过标准和原则避免常见错误

---

## 🧪 测试建议

### 保留测试用例1（命名类）

```
输入: "8间包房,以苏东坡的诗词命名,4个字,传递生活态度和价值观,不落俗套"

预期: naming_list (8个四字命名)

原因: 在系统能力范围内（文案创作），无需转化
```

### 修正测试用例2-5

所有涉及"图纸/清单/参数"的需求，预期输出应为：
- design_strategy (而非 design_plan)
- selection_framework (而非 technical_spec)
- procurement_guidance (而非 procurement_list)
- budget_framework (而非 cost_estimate)

---

## 📈 预期改进效果

### Phase 1.0 的问题

| 维度 | 问题 |
|------|------|
| **承诺** | 承诺了无法兑现的交付物 |
| **用户期望** | 期望得到图纸/清单，实际无法交付 |
| **系统定位** | 模糊，用户误以为系统万能 |
| **交付价值** | 提供了大量分析但缺少核心交付 |

### Phase 1.1 的改进

| 维度 | 改进 |
|------|------|
| **承诺** | 仅承诺可兑现的策略/指导 |
| **用户期望** | 理解系统定位，期望策略而非图纸 |
| **系统定位** | 清晰，明确为策略/概念层系统 |
| **交付价值** | 提供有价值的决策依据和方法论 |

---

## ⚠️ 注意事项

### 用户沟通要点

当用户提出超出能力的需求时，系统应：

1. **诚实说明能力边界**
   - "本系统专注于策略/概念层，无法生成CAD图纸"

2. **提供替代方案**
   - "我们可以提供空间设计策略文档，包含规划思路和决策依据"

3. **强调替代价值**
   - "策略文档可作为建筑师/设计师的工作基础，节省前期思考时间"

4. **建议后续接力**
   - "基于策略文档，您可以委托专业设计师完成图纸绘制"

### 问卷第1题示例

```json
{
  "question": "您最核心的交付期望是(可多选):",
  "options": [
    "选项1: 8个苏东坡诗词命名方案(含出处和价值观) ← ✅ 系统可完整交付",
    "选项2: 空间设计策略文档(规划思路/功能分区/材料指导) ← ✅ 系统可完整交付",
    "选项3: 具体平面图/施工图/材料清单 ← ⚠️ 超出系统能力，需人工设计师接力"
  ],
  "note": "本系统专注于策略/概念/分析层面，不具备图纸绘制和产品数据库能力"
}
```

---

## 📝 后续建议

### 短期（Phase 1.1 验证）

1. **运行修正后的测试**
   - 使用命名类需求验证核心逻辑
   - 使用设计类需求验证转化逻辑

2. **观察LLM的理解**
   - 是否正确识别能力边界
   - 是否正确进行转化

3. **评估用户接受度**
   - 用户是否理解系统定位
   - 策略/指导类交付物是否有价值

### 中期（如果Phase 1.1成功）

1. **完善能力边界文档**
   - 详细列出每种交付物的能力边界
   - 建立转化规则库

2. **优化问卷设计**
   - 在问卷中更早管理期望
   - 提供清晰的能力说明

### 长期（系统进化方向）

1. **考虑能力扩展**
   - 是否集成图纸生成工具API
   - 是否集成产品数据库

2. **建立人机协作流程**
   - 系统输出策略→人工执行→反馈优化

---

## 📞 相关文件

- **[PHASE1_COMPLETION_SUMMARY.md](PHASE1_COMPLETION_SUMMARY.md)** - Phase 1.0 完整总结
- **[PHASE1_QUICK_REFERENCE.md](PHASE1_QUICK_REFERENCE.md)** - 快速参考指南
- **[test_phase1_improvements.md](test_phase1_improvements.md)** - 测试用例（需更新）
- **[requirements_analyst_lite.yaml](intelligent_project_analyzer/config/prompts/requirements_analyst_lite.yaml)** - 修改后的配置
- **[project_director.yaml](intelligent_project_analyzer/config/prompts/project_director.yaml)** - 修改后的配置

---

**修正状态:** ✅ Phase 1.1 已完成
**下一步:** 运行测试验证修正效果
**建议测试:** 先测试命名类（无需转化），再测试设计类（验证转化逻辑）
